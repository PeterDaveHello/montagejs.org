montageDefine("af8ae5e","ctype",{dependencies:["./ctf.js","./ctio.js","assert"],factory:function(e,t,n){function u(e,t,n){var r=i.ruint8(t,e,n);return{value:r,size:1}}function a(e,t,n){var r=i.ruint16(t,e,n);return{value:r,size:2}}function f(e,t,n){var r=i.ruint32(t,e,n);return{value:r,size:4}}function l(e,t,n){var r=i.ruint64(t,e,n);return{value:r,size:8}}function c(e,t,n){var r=i.rsint8(t,e,n);return{value:r,size:1}}function h(e,t,n){var r=i.rsint16(t,e,n);return{value:r,size:2}}function p(e,t,n){var r=i.rsint32(t,e,n);return{value:r,size:4}}function d(e,t,n){var r=i.rsint64(t,e,n);return{value:r,size:8}}function v(e,t,n){var r=i.rfloat(t,e,n);return{value:r,size:4}}function m(e,t,n){var r=i.rdouble(t,e,n);return{value:r,size:8}}function g(e,t,n){var r=new Buffer(1);return r[0]=i.ruint8(t,e,n),{value:r,size:1}}function y(e,t,n,r){var s,o=new Buffer(e);for(s=0;s<e;s++)o[s]=i.ruint8(n,t,r+s);return{value:o,size:e}}function b(e,t,n,r){return i.wuint8(e,t,n,r),1}function w(e,t,n,r){return i.wuint16(e,t,n,r),2}function E(e,t,n,r){return i.wuint32(e,t,n,r),4}function S(e,t,n,r){return i.wuint64(e,t,n,r),8}function x(e,t,n,r){return i.wsint8(e,t,n,r),1}function T(e,t,n,r){return i.wsint16(e,t,n,r),2}function N(e,t,n,r){return i.wsint32(e,t,n,r),4}function C(e,t,n,r){return i.wsint64(e,t,n,r),8}function k(e,t,n,r){return i.wfloat(e,t,n,r),4}function L(e,t,n,r){return i.wdouble(e,t,n,r),8}function A(e,t,n,r){if(e instanceof Buffer)return i.ruint8(e[0],t,n,r),1;throw new Error("Input must be a buffer")}function O(e,t,n,r,s){var o;if(e instanceof Buffer){if(e.length>t)throw new Error("value length greater than array length");for(o=0;o<e.length&&o<t;o++)i.wuint8(e[o],n,r,s+o);for(;o<t;o++)i.wuint8(0,n,s+o);return t}throw new Error("Input must be a buffer")}function M(){var e={},t;for(t in o)e[t]=o[t];return e}function _(e){var t,n,r,i;if(typeof e!="string")throw new Error("type must be a Javascript string");n=e.lastIndexOf("]");if(n==-1){if(e.lastIndexOf("[")!=-1)throw new Error("found invalid type with '[' but no corresponding ']'");return{type:e}}t=e.lastIndexOf("[");if(t==-1)throw new Error("found invalid type with ']' but no corresponding '['");if(t>=n)throw new Error("malformed type, ']' appears before '['");return r=e.substring(0,t),i=e.substring(t+1,n),{type:r,len:i}}function D(e,t,n){var r,i,s,o,u,a={};if(!(e instanceof Array))throw new Error("definition is not an array");if(e.length===0)throw new Error("definition must have at least one element");for(r=0;r<e.length;r++){s=e[r];if(!(s instanceof Object))throw new Error("definition must be an array ofobjects");o=Object.keys(s);if(o.length!=1)throw new Error("definition entry must only have one key");if(o[0]in a)throw new Error("Specified name already specified: "+o[0]);if(!("type"in s[o[0]]))throw new Error("missing required type definition");u=_(s[o[0]].type);while(u.len!==undefined){if(!(!isNaN(parseInt(u.len,10))||u.len in a))throw new Error("Given an array length without a matching type");u=_(u.type)}if(!(u.type in t))throw new Error("type not found or typdefed: "+u.type);if(n!==undefined)for(i=0;i<n.length;i++)if(!(n[i]in s[o[0]]))throw new Error("Missing required field: "+n[i]);a[o[0]]=!0}}function P(e){if(!e)throw new Error("missing required argument");if(!("endian"in e))throw new Error("missing required endian value");if(e["endian"]!="big"&&e["endian"]!="little")throw new Error("Invalid endian type");if("char-type"in e&&e["char-type"]!="uint8"&&e["char-type"]!="int8")throw new Error("invalid option for char-type: "+e["char-type"]);this.endian=e.endian,this.types=M(),"char-type"in e&&e["char-type"]=="uint8"&&(this.types["char"]=this.types.uint8_t),"char-type"in e&&e["char-type"]=="int8"&&(this.types["char"]=this.types.int8_t)}function H(e,t){var n="",r=_(e);while(r.len!==undefined){if(isNaN(parseInt(r.len,10))){if(typeof t[r["len"]]!="number")throw new Error("cannot sawp in non-number for array value");n="["+t[r.len]+"]"+n}else n="["+r.len+"]"+n;r=_(r.type)}return n=r.type+n,n}function B(e){var t,n,r;n=[];for(t=0;t<e.length;t++)r=Object.keys(e[t])[0],s.ok("value"in e[t][r]),n.push(e[t][r].value);return n}function j(e){if(e===undefined)throw new Error("missing required arg: value");if(!Array.isArray(e))throw new Error("value must be an array");if(e.length!=2)throw new Error("value must be an array of length 2");if(e[0]>=1048576)throw new Error("value would become approximated");return e[0]*Math.pow(2,32)+e[1]}function F(e){if(e===undefined)throw new Error("missing required arg: value");if(!Array.isArray(e))throw new Error("value must be an array");if(e.length!=2)throw new Error("value must be an array of length 2");return Math.pow(2,32)*e[0]+e[1]}function I(e,t){var n=new P(t);return r.ctfParseJson(e,n),n}var r=e("./ctf.js"),i=e("./ctio.js"),s=e("assert"),o={uint8_t:{read:u,write:b},uint16_t:{read:a,write:w},uint32_t:{read:f,write:E},uint64_t:{read:l,write:S},int8_t:{read:c,write:x},int16_t:{read:h,write:T},int32_t:{read:p,write:N},int64_t:{read:d,write:C},"float":{read:v,write:k},"double":{read:m,write:L},"char":{read:g,write:A},"char[]":{read:y,write:O}};P.prototype.setEndian=function(e){if(e!="big"&&e!="little")throw new Error("invalid endian type, must be big or little");this.endian=e},P.prototype.getEndian=function(){return this.endian},P.prototype.typedef=function(e,t){var n;if(e===undefined)throw new(Error("missing required typedef argument: name"));if(t===undefined)throw new(Error("missing required typedef argument: value"));if(typeof e!="string")throw new(Error("the name of a type must be a string"));n=_(e);if(n.len!==undefined)throw new Error("Cannot have an array in the typedef name");if(e in this.types)throw new Error("typedef name already present: "+e);if(!(typeof t=="string"||t instanceof Array))throw new Error("typedef value must either be a string or struct");if(typeof t=="string"){n=_(t);if(n.len!==undefined&&isNaN(parseInt(n.len,10)))throw new(Error("typedef value must use fixed size array when outside of a struct"));this.types[e]=t}else D(t,this.types),this.types[e]=t},P.prototype.lstypes=function(){var e,t={};for(e in this.types){if(e in o)continue;t[e]=this.types[e]}return t},P.prototype.resolveTypedef=function(e,t,n,r,i){var o;s.ok(e in this.types);if(typeof this.types[e]=="string"){o=_(this.types[e]);if(t=="read")return this.readEntry(o,n,r);if(t=="write")return this.writeEntry(i,o,n,r);throw new Error("invalid dispatch type to resolveTypedef")}if(t=="read")return this.readStruct(this.types[e],n,r);if(t=="write")return this.writeStruct(i,this.types[e],n,r);throw new Error("invalid dispatch type to resolveTypedef")},P.prototype.readEntry=function(e,t,n){var r,i;if(e.len!==undefined){i=parseInt(e.len,10);if(isNaN(i))throw new Error("somehow got a non-numeric length");e["type"]=="char"?r=this.types["char[]"].read(i,this.endian,t,n):r=this.readArray(e.type,i,t,n)}else e.type in o?r=this.types[e.type].read(this.endian,t,n):r=this.resolveTypedef(e.type,"read",t,n);return r},P.prototype.readArray=function(e,t,n,r){var i,s,o,u=r,a=new Array(t);o=_(e);for(i=0;i<t;i++)s=this.readEntry(o,n,r),r+=s.size,a[i]=s.value;return{value:a,size:r-u}},P.prototype.readStruct=function(e,t,n){var r,i,s,o,u,a=n,f={};for(i=0;i<e.length;i++)u=Object.keys(e[i])[0],o=e[i][u],s=_(H(o.type,f)),"offset"in o&&(n=a+o.offset),r=this.readEntry(s,t,n),n+=r.size,f[u]=r.value;return{value:f,size:n-a}},P.prototype.readData=function(e,t,n){if(e===undefined)throw new Error("missing definition for what we should beparsing");if(t===undefined)throw new Error("missing buffer for what we should be parsing");if(n===undefined)throw new Error("missing offset for what we should be parsing");return D(e,this.types),this.readStruct(e,t,n).value},P.prototype.writeArray=function(e,t,n,r,i){var s,o,u=i;if(e instanceof Array){if(e.length!=n)throw new Error("asked to write array of length "+n+" but that does not match value length: "+e.length);o=_(t);for(s=0;s<n;s++)i+=this.writeEntry(e[s],o,r,i);return i-u}throw new Error("asked to write an array, but value is not an array")},P.prototype.writeEntry=function(e,t,n,r){var i,s;if(t.len!==undefined){i=parseInt(t.len,10);if(isNaN(i))throw new Error("somehow got a non-numeric length");t["type"]=="char"?s=this.types["char[]"].write(e,i,this.endian,n,r):s=this.writeArray(e,t.type,i,n,r)}else t.type in o?s=this.types[t.type].write(e,this.endian,n,r):s=this.resolveTypedef(t.type,"write",n,r,e);return s},P.prototype.writeStruct=function(e,t,n,r){var i,s,o,u,a=r,f={};for(i=0;i<t.length;i++)u=Object.keys(t[i])[0],s=t[i][u],o=_(H(s.type,f)),"offset"in s&&(r=a+s.offset),r+=this.writeEntry(e[i],o,n,r),f[u]=e[i];return r},P.prototype.writeData=function(e,t,n,r){var i;if(e===undefined)throw new Error("missing definition for what we should beparsing");if(t===undefined)throw new Error("missing buffer for what we should be parsing");if(n===undefined)throw new Error("missing offset for what we should be parsing");i=r!=null&&r!=undefined;if(i){if(!Array.isArray(r))throw new Error("missing values for writing");D(e,this.types)}else D(e,this.types,["value"]);this.writeStruct(i?r:B(e),e,t,n)},t.Parser=P,t.toAbs64=j,t.toApprox64=F,t.parseCTF=I,t.ruint8=i.ruint8,t.ruint16=i.ruint16,t.ruint32=i.ruint32,t.ruint64=i.ruint64,t.wuint8=i.wuint8,t.wuint16=i.wuint16,t.wuint32=i.wuint32,t.wuint64=i.wuint64,t.rsint8=i.rsint8,t.rsint16=i.rsint16,t.rsint32=i.rsint32,t.rsint64=i.rsint64,t.wsint8=i.wsint8,t.wsint16=i.wsint16,t.wsint32=i.wsint32,t.wsint64=i.wsint64,t.rfloat=i.rfloat,t.rdouble=i.rdouble,t.wfloat=i.wfloat,t.wdouble=i.wdouble}})