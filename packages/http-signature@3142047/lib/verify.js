var assert=require("assert-plus"),crypto=require("crypto");module.exports={verifySignature:function(t,n){assert.object(t,"parsedSignature"),assert.string(n,"key");var r=t.algorithm.match(/(HMAC|RSA|DSA)-(\w+)/);if(!r||r.length!==3)throw new TypeError("parsedSignature: unsupported algorithm "+t.algorithm);if(r[1]==="HMAC"){var i=crypto.createHmac(r[2].toLowerCase(),n);return i.update(t.signingString),i.digest("base64")===t.signature}var s=crypto.createVerify(r[0]);return s.update(t.signingString),s.verify(n,t.signature,"base64")}}