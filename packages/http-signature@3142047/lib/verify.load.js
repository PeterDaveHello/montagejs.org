montageDefine("3142047","lib/verify",{dependencies:["assert-plus","crypto"],factory:function(e,t,n){var r=e("assert-plus"),i=e("crypto");n.exports={verifySignature:function(t,n){r.object(t,"parsedSignature"),r.string(n,"key");var s=t.algorithm.match(/(HMAC|RSA|DSA)-(\w+)/);if(!s||s.length!==3)throw new TypeError("parsedSignature: unsupported algorithm "+t.algorithm);if(s[1]==="HMAC"){var o=i.createHmac(s[2].toLowerCase(),n);return o.update(t.signingString),o.digest("base64")===t.signature}var u=i.createVerify(s[0]);return u.update(t.signingString),u.verify(n,t.signature,"base64")}}}})