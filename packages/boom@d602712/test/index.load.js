montageDefine("d602712","test/index",{dependencies:["lab","../lib"],factory:function(e,t,n){var r=e("lab"),i=e("../lib"),s={},o=r.expect,u=r.before,a=r.after,f=r.experiment,l=r.test;f("Boom",function(){l("returns an error with info when constructed using another error",function(e){var t=new Error("ka-boom");t.xyz=123;var n=new i(t);o(n.data.xyz).to.equal(123),o(n.message).to.equal("ka-boom"),o(n.response).to.deep.equal({code:500,payload:{code:500,error:"Internal Server Error",message:"ka-boom"},headers:{}}),e()}),f("#isBoom",function(){l("returns true for Boom object",function(e){o(i.badRequest().isBoom).to.equal(!0),e()}),l("returns false for Error object",function(e){o((new Error).isBoom).to.not.exist,e()})}),f("#badRequest",function(){l("returns a 400 error code",function(e){o(i.badRequest().response.code).to.equal(400),e()}),l("sets the message with the passed in message",function(e){o(i.badRequest("my message").message).to.equal("my message"),e()})}),f("#unauthorized",function(){l("returns a 401 error code",function(e){var t=i.unauthorized();o(t.response.code).to.equal(401),o(t.response.headers).to.deep.equal({}),e()}),l("sets the message with the passed in message",function(e){o(i.unauthorized("my message").message).to.equal("my message"),e()}),l("returns a WWW-Authenticate header when passed a scheme",function(e){var t=i.unauthorized("boom","Test");o(t.response.code).to.equal(401),o(t.response.headers["WWW-Authenticate"]).to.equal('Test error="boom"'),e()}),l("returns a WWW-Authenticate header when passed a scheme and attributes",function(e){var t=i.unauthorized("boom","Test",{a:1,b:"something",c:null,d:0});o(t.response.code).to.equal(401),o(t.response.headers["WWW-Authenticate"]).to.equal('Test a="1", b="something", c="", d="0", error="boom"'),e()}),l("sets the isMissing flag when error message is empty",function(e){var t=i.unauthorized("","Basic");o(t.isMissing).to.equal(!0),e()}),l("does not set the isMissing flag when error message is not empty",function(e){var t=i.unauthorized("message","Basic");o(t.isMissing).to.equal(undefined),e()}),l("sets a WWW-Authenticate when passed as an array",function(e){var t=i.unauthorized("message",["Basic",'Example e="1"','Another x="3", y="4"']);o(t.response.headers["WWW-Authenticate"]).to.equal('Basic, Example e="1", Another x="3", y="4"'),e()})}),f("#clientTimeout",function(){l("returns a 408 error code",function(e){o(i.clientTimeout().response.code).to.equal(408),e()}),l("sets the message with the passed in message",function(e){o(i.clientTimeout("my message").message).to.equal("my message"),e()})}),f("#serverTimeout",function(){l("returns a 503 error code",function(e){o(i.serverTimeout().response.code).to.equal(503),e()}),l("sets the message with the passed in message",function(e){o(i.serverTimeout("my message").message).to.equal("my message"),e()})}),f("#forbidden",function(){l("returns a 403 error code",function(e){o(i.forbidden().response.code).to.equal(403),e()}),l("sets the message with the passed in message",function(e){o(i.forbidden("my message").message).to.equal("my message"),e()})}),f("#notFound",function(){l("returns a 404 error code",function(e){o(i.notFound().response.code).to.equal(404),e()}),l("sets the message with the passed in message",function(e){o(i.notFound("my message").message).to.equal("my message"),e()})}),f("#internal",function(){l("returns a 500 error code",function(e){o(i.internal().response.code).to.equal(500),e()}),l("sets the message with the passed in message",function(e){var t=i.internal("my message");o(t.message).to.equal("my message"),o(t.response.payload.message).to.equal("An internal server error occurred"),e()}),l("passes data on the callback if its passed in",function(e){o(i.internal("my message",{my:"data"}).data.my).to.equal("data"),e()}),l("uses passed in stack if its available",function(e){var t=new Error;t.stack="my stack line\nmy second stack line",o(i.internal("my message",t).trace[0]).to.equal("my stack line"),e()})}),f("#passThrough",function(){l("returns a pass-through error",function(e){var t=i.passThrough(499,{a:1},"application/text",{"X-Test":"Boom"});o(t.response.code).to.equal(499),o(t.message).to.equal("Pass-through"),o(t.response).to.deep.equal({code:499,payload:{a:1},headers:{"X-Test":"Boom"},type:"application/text"}),e()})}),f("#reformat",function(){l("encodes any HTML markup in the response payload",function(e){var t=new i(new Error("<script>alert(1)</script>"));o(t.response.payload.message).to.not.contain("<script>"),e()})})})}})