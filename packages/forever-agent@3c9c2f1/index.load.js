montageDefine("3c9c2f1","index",{dependencies:["util","http","net","tls","https"],factory:function(e,t,n){function a(e){var t=this;t.options=e||{},t.requests={},t.sockets={},t.freeSockets={},t.maxSockets=t.options.maxSockets||i.defaultMaxSockets,t.minSockets=t.options.minSockets||a.defaultMinSockets,t.on("free",function(e,n,r){var i=n+":"+r;if(t.requests[i]&&t.requests[i].length)t.requests[i].shift().onSocket(e);else if(t.sockets[i].length<t.minSockets){t.freeSockets[i]||(t.freeSockets[i]=[]),t.freeSockets[i].push(e);function s(){e.destroy()}e._onIdleError=s,e.on("error",s)}else e.destroy()})}function f(e){a.call(this,e)}function l(e,t,n){return typeof e=="object"?n=e:typeof t=="object"?n=t:typeof n=="object"?n=n:n={},typeof e=="number"&&(n.port=e),typeof t=="string"&&(n.host=t),o.connect(n)}n.exports=a,a.SSL=f;var r=e("util"),i=e("http").Agent,s=e("net"),o=e("tls"),u=e("https").Agent;r.inherits(a,i),a.defaultMinSockets=5,a.prototype.createConnection=s.createConnection,a.prototype.addRequestNoreuse=i.prototype.addRequest,a.prototype.addRequest=function(e,t,n){var r=t+":"+n;if(this.freeSockets[r]&&this.freeSockets[r].length>0&&!e.useChunkedEncodingByDefault){var i=this.freeSockets[r].pop();i.removeListener("error",i._onIdleError),delete i._onIdleError,e._reusedSocket=!0,e.onSocket(i)}else this.addRequestNoreuse(e,t,n)},a.prototype.removeSocket=function(e,t,n,r){if(this.sockets[t]){var i=this.sockets[t].indexOf(e);i!==-1&&this.sockets[t].splice(i,1)}else this.sockets[t]&&this.sockets[t].length===0&&(delete this.sockets[t],delete this.requests[t]);if(this.freeSockets[t]){var i=this.freeSockets[t].indexOf(e);i!==-1&&(this.freeSockets[t].splice(i,1),this.freeSockets[t].length===0&&delete this.freeSockets[t])}this.requests[t]&&this.requests[t].length&&this.createSocket(t,n,r).emit("free")},r.inherits(f,a),f.prototype.createConnection=l,f.prototype.addRequestNoreuse=u.prototype.addRequest}})