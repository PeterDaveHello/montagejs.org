montageDefine("749e350","lib/jsdom/level2/core",{dependencies:["../level1/core"],factory:function(e,t,n){var r=e("../level1/core").dom.level1.core;r=Object.create(r);var i=r.INVALID_STATE_ERR=11,s=r.SYNTAX_ERR=12,o=r.INVALID_MODIFICATION_ERR=13,u=r.NAMESPACE_ERR=14,a=r.INVALID_ACCESS_ERR=15,f={validate:function(e,t){if(!e)throw new r.DOMException(r.INVALID_CHARACTER_ERR,"namespace is undefined");if(e.match(/[^0-9a-z\.:\-_]/i)!==null)throw new r.DOMException(r.INVALID_CHARACTER_ERR,e);var n=!1,i=e.split(":");e==="xmlns"&&t!=="http://www.w3.org/2000/xmlns/"?n="localName is 'xmlns' but the namespaceURI is invalid":e==="xml"&&t!=="http://www.w3.org/XML/1998/namespace"?n="localName is 'xml' but the namespaceURI is invalid":e[e.length-1]===":"?n="Namespace seperator found with no localName":e[0]===":"?n="Namespace seperator found, without a prefix":i.length>2&&(n="Too many namespace seperators");if(n)throw new r.DOMException(u,n+" ("+e+"@"+t+")")}};r.exceptionMessages.NAMESPACE_ERR="Invalid namespace",r.DOMImplementation.prototype.createDocumentType=function(e,t,n){f.validate(e);var i=new r.DocumentType(null,e);return i._publicId=t?t:"",i._systemId=n?n:"",i},r.DOMImplementation.prototype.createDocument=function(e,t,n){(t||e)&&f.validate(t,e);if(n&&n._ownerDocument!==null)throw new r.DOMException(r.WRONG_DOCUMENT_ERR);if(t&&t.indexOf(":")>-1&&!e)throw new r.DOMException(u);var i=new r.Document;n?(i.doctype=n,n._ownerDocument=i,i.appendChild(n)):i.doctype=null,n&&!n.entities&&(n.entities=new dom.EntityNodeMap),i._ownerDocument=i;if(t){var s=i.createElementNS(e,t);i.appendChild(s)}return i},r.Node.prototype.__defineGetter__("ownerDocument",function(){return this._ownerDocument||null}),r.Node.prototype.isSupported=function(e,t){return this._ownerDocument.implementation.hasFeature(e,t)},r.Node.prototype._namespaceURI=null,r.Node.prototype.__defineGetter__("namespaceURI",function(){return this._namespaceURI||null}),r.Node.prototype.__defineSetter__("namespaceURI",function(e){this._namespaceURI=e}),r.Node.prototype.__defineGetter__("prefix",function(){return this._prefix||null}),r.Node.prototype.__defineSetter__("prefix",function(e){if(this.readonly)throw new r.DOMException(r.NO_MODIFICATION_ALLOWED_ERR);f.validate(e,this._namespaceURI);if(this._created&&!this._namespaceURI||this._prefix==="xmlns"||!this._prefix&&this._created)throw new r.DOMException(r.NAMESPACE_ERR);this._localName&&(this._nodeName=e+":"+this._localName),this._prefix=e}),r.Node.prototype.__defineGetter__("localName",function(){return this._localName||null}),r.Node.prototype.hasAttributes=function(){return this.nodeType===this.ELEMENT_NODE&&this._attributes&&this._attributes.length>0},r.NamedNodeMap.prototype.getNamedItemNS=function(e,t){return this._nsStore[e]&&this._nsStore[e][t]?this._nsStore[e][t]:null},r.AttrNodeMap.prototype.setNamedItemNS=function(e){if(e.nodeType!==this._ownerDocument.ATTRIBUTE_NODE)throw new r.DOMException(r.HIERARCHY_REQUEST_ERR);return r.NamedNodeMap.prototype.setNamedItemNS.call(this,e)};var l=r.AttrNodeMap.prototype.setNamedItem;r.AttrNodeMap.prototype.setNamedItem=function(e){if(e.nodeType!==this._ownerDocument.ATTRIBUTE_NODE)throw new r.DOMException(r.HIERARCHY_REQUEST_ERR);return l.call(this,e)},r.NamedNodeMap.prototype.setNamedItemNS=function(e){if(this._readonly)throw new r.DOMException(r.NO_MODIFICATION_ALLOWED_ERR);var t=this._ownerDocument;if(this._parentNode&&this._parentNode._parentNode&&this._parentNode._parentNode.nodeType===t.ENTITY_NODE)throw new r.DOMException(r.NO_MODIFICATION_ALLOWED_ERR);if(this._ownerDocument!==e.ownerDocument)throw new r.DOMException(r.WRONG_DOCUMENT_ERR);if(e._ownerElement)throw new r.DOMException(r.INUSE_ATTRIBUTE_ERR);if(this._readonly===!0)throw new r.DOMException(NO_MODIFICATION_ALLOWED_ERR);this._nsStore[e.namespaceURI]||(this._nsStore[e.namespaceURI]={});var n=null;if(this._nsStore[e.namespaceURI][e.localName])var n=this._nsStore[e.namespaceURI][e.localName];return this._nsStore[e.namespaceURI][e.localName]=e,e._specified=!0,e._ownerDocument=this._ownerDocument,this.setNamedItem(e)},r.NamedNodeMap.prototype.removeNamedItemNS=function(e,t){if(this.readonly)throw new r.DOMException(r.NO_MODIFICATION_ALLOWED_ERR);var n=this._parentNode,i=null,s,o,u,a;if(this._parentNode&&this._parentNode._parentNode&&this._parentNode._parentNode.nodeType===this._ownerDocument.ENTITY_NODE)throw new r.DOMException(r.NO_MODIFICATION_ALLOWED_ERR);this._nsStore[e]&&this._nsStore[e][t]&&(i=this._nsStore[e][t],this.removeNamedItem(i.qualifiedName),delete this._nsStore[e][t]);if(!i)throw new r.DOMException(r.NOT_FOUND_ERR);return n.ownerDocument.doctype&&n.ownerDocument.doctype._attributes&&(s=n.ownerDocument.doctype._attributes,u=s.getNamedItemNS(n._namespaceURI,n._localName)),u&&(a=u._attributes.getNamedItemNS(e,t),a&&(o=a.cloneNode(!0),o._created=!1,o._namespaceURI=i._namespaceURI,o._nodeName=i.name,o._localName=i._localName,o._prefix=i._prefix,this.setNamedItemNS(o),o._created=!0,o._specified=!1)),i},r.Attr.prototype.__defineGetter__("ownerElement",function(){return this._ownerElement||null}),r.Node.prototype._prefix=!1,r.Node.prototype.__defineSetter__("qualifiedName",function(e){f.validate(e,this._namespaceURI),e=e||"",this._localName=e.split(":")[1]||null,this.prefix=e.split(":")[0]||null,this._nodeName=e}),r.Node.prototype.__defineGetter__("qualifiedName",function(){return this._nodeName}),r.NamedNodeMap.prototype._map=function(e){var t=[],n=this.length,r=0,i;for(r;r<n;r++)i=this.item(r),e&&e(i)&&t.push(i);return t},r.Element.prototype.getAttributeNS=function(e,t){var n=this._attributes.getNamedItemNS(e,t);return n?n.nodeValue:""},r.Element.prototype.setAttributeNS=function(e,t,n){var i=t.split(":"),s=i.pop(),o=i.pop()||null,u;f.validate(t,e);if(t.split(":").shift()==="xml"&&e!=="http://www.w3.org/XML/1998/namespace")throw new r.DOMException(r.NAMESPACE_ERR);if(o==="xmlns"&&e!=="http://www.w3.org/2000/xmlns/")throw new r.DOMException(r.NAMESPACE_ERR);if(t.split(":").length>1&&!e)throw new r.DOMException(r.NAMESPACE_ERR);u=this._attributes.getNamedItemNS(e,s),u||(u=this.ownerDocument.createAttributeNS(e,t,n),this._attributes.setNamedItemNS(u)),u._namespaceURI=e,u._prefix=o,u._created=!0,u.value=n,u._localName=s},r.Element.prototype.removeAttributeNS=function(e,t){if(this.readonly)throw new r.DOMException(r.NO_MODIFICATION_ALLOWED_ERR);var n=this.ownerDocument,i,s,o,u,s,t;n.doctype&&n.doctype._attributes&&(i=n.doctype._attributes,o=i.getNamedItemNS(e,this.localName)),o&&(u=o.getAttributeNodeNS(e,t)),this._attributes.removeNamedItemNS(e,t),u&&(this.setAttributeNS(u.namespaceURI,u.name,u.value),t=u.name.split(":").pop(),s=this.getAttributeNS(u.namespaceURI,t),s._specified=!1)},r.Element.prototype.getAttributeNodeNS=function(e,t){return this._attributes.getNamedItemNS(e,t)},r.Element.prototype._created=!1,r.Element.prototype.setAttributeNodeNS=function(e){if(e.ownerElement)throw new r.DOMException(r.INUSE_ATTRIBUTE_ERR);var t=null;try{t=this._attributes.removeNamedItemNS(e.namespaceURI,e.localName)}catch(n){}return this._attributes.setNamedItemNS(e)||t},r.Element.prototype.getElementsByTagNameNS=function(e,t){function i(n){n.nodeType&&n.nodeType===this.ENTITY_REFERENCE_NODE&&(n=n._entity);var r=n.localName===t,i=n.namespaceURI===e;return!r&&t!=="*"||!i&&e!=="*"||n.nodeType!==n.ELEMENT_NODE?!1:!0}var n={};return new r.NodeList(this.ownerDocument||this,r.mapper(this,i))},r.Element.prototype.hasAttribute=function(e){return this._attributes?this._attributes.exists(e):!1},r.Element.prototype.hasAttributeNS=function(e,t){return this._attributes.getNamedItemNS(e,t)?!0:this.hasAttribute(t)?!0:!1},r.DocumentType.prototype.__defineGetter__("publicId",function(){return this._publicId||""}),r.DocumentType.prototype.__defineGetter__("systemId",function(){return this._systemId||""}),r.DocumentType.prototype.__defineGetter__("internalSubset",function(){return this._internalSubset||null}),r.Document.prototype.importNode=function(e,t){function u(e){var t,r;e._ownerDocument=n,e.id&&(n._ids||(n._ids={}),n._ids[e.id]||(n._ids[e.id]=[]),n._ids[e.id].push(e));if(e._attributes){e._attributes._ownerDocument=n;for(var i=0,o=e._attributes.length;i<o;i++)t=e._attributes.item(i),t._ownerDocument=n,t._specified=!0}s&&(r=s.getNamedItemNS(e._namespaceURI,e._localName),r&&r._attributes._map(function(t){if(!e.hasAttributeNS(t.namespaceURL,t.localName)){var n=t.cloneNode(!0);n._namespaceURI=t._namespaceURI,n._prefix=t._prefix,n._localName=t._localName,e.setAttributeNodeNS(n),n._specified=!1}}))}if(e&&e.nodeType)if(e.nodeType===this.DOCUMENT_NODE||e.nodeType===this.DOCUMENT_TYPE_NODE)throw new r.DOMException(r.NOT_SUPPORTED_ERR);var n=this,i=e.cloneNode(t,function(e,t){t._namespaceURI=e._namespaceURI,t._nodeName=e._nodeName,t._localName=e._localName}),s=!1,o;return this.doctype&&this.doctype._attributes&&(s=this.doctype._attributes),t?r.visitTree(i,u):u(i),i.nodeType==i.ATTRIBUTE_NODE&&(i._specified=!0),i},r.Document.prototype.createElementNS=function(e,t){var n=t.split(":"),i,s;if(n.length>1&&!e)throw new r.DOMException(r.NAMESPACE_ERR);return f.validate(t,e),i=this.createElement(t),i._created=!1,i._namespaceURI=e,i._nodeName=t,i._localName=n.pop(),n.length>0&&(s=n.pop(),i.prefix=s),i._created=!0,i},r.Document.prototype.createAttributeNS=function(e,t){var n,i=t.split(":");if(i.length>1&&!e)throw new r.DOMException(r.NAMESPACE_ERR,"Prefix specified without namespaceURI ("+t+")");return f.validate(t,e),n=this.createAttribute(t),n.namespaceURI=e,n.qualifiedName=t,n._localName=i.pop(),n._prefix=i.length>0?i.pop():null,n},r.Document.prototype.getElementsByTagNameNS=function(e,t){return r.Element.prototype.getElementsByTagNameNS.call(this,e,t)},r.Element.prototype.__defineSetter__("id",function(e){this.setAttribute("id",e)}),r.Element.prototype.__defineGetter__("id",function(){return this.getAttribute("id")}),r.Document.prototype.getElementById=function(e){return this._ids&&this._ids[e]&&this._ids[e].length>0?this._ids[e][0]:null},t.dom={level2:{core:r}}}})