montageDefine("749e350","lib/jsdom/browser/index",{dependencies:["http","url","./htmltodom","./domtohtml","./htmlencoding","../../jsdom","contextify","vm","htmlparser","node-htmlparser/lib/node-htmlparser"],factory:function(e,t,n){function p(e){return function(){if(!l.debugMode){var t=e?e.raise:this.raise;t.call(this,"error","NOT IMPLEMENTED")}}}function v(){if(d===null)try{d=e("htmlparser")}catch(t){try{d=e("node-htmlparser/lib/node-htmlparser")}catch(n){d=undefined}}return d}var r=e("http"),i=e("url"),s=e("./htmltodom").HtmlToDom,o=e("./domtohtml").domToHtml,u=e("./htmlencoding"),a=u.HTMLEncode,f=u.HTMLDecode,l=e("../../jsdom"),c=null;try{c=e("contextify")}catch(h){c=function(t){var n=e("vm"),r=n.createContext(t),i=null;return t.run=function(e,t){return n.runInContext(e,r,t)},t.getGlobal=function(){return i||(i=n.runInContext("this",r)),i},t.dispose=function(){i=null,t.run=function(){throw new Error("Called run() after dispose().")},t.getGlobal=function(){throw new Error("Called getGlobal() after dispose().")},t.dispose=function(){throw new Error("Called dispose() after dispose().")}},t}}t.windowAugmentation=function(n,r){r=r||{};var i=t.createWindow(n,r);if(!r.document){var s=m(n,r);r.features&&r.features.QuerySelector&&e(__dirname+"/../selectors/index").applyQuerySelectorPrototype(s),r.document=s.HTMLDocument?new s.HTMLDocument(r):new s.Document(r),r.document.write("<html><head></head><body></body></html>")}var o=i.document=r.document;if(o.addEventListener)if(o.readyState=="complete"){var u=o.createEvent("HTMLEvents");u.initEvent("load",!1,!1),i.dispatchEvent(u)}else o.addEventListener("load",function(e){i.dispatchEvent(e)});return i},t.createWindow=function(e,t){function r(e,t,r,i){var s=e(r,i);return n.push([s,t]),s}function s(e){if(typeof e=="undefined")return;for(var t in n)if(n[t][0]===e){n[t][1].call(this,e),n.splice(t,1);break}}function o(){n.forEach(function(e){e[1].call(this,e[0])}),n=[]}function u(t){var n=(t||{}).url||"file://"+__filename;this.location=i.parse(n),this.location.reload=p(this),this.location.replace=p(this),this.location.toString=function(){return n};var u=this.console._window=this;this.location.__defineGetter__("hash",function(){return u.location.href.split("#").length>1?"#"+u.location.href.split("#")[1]:""}),this.location.__defineSetter__("hash",function(e){u.location.href=u.location.href.split("#")[0]+e}),this.location.__defineGetter__("search",function(){return u.location.href.split("?").length>1?"?"+u.location.href.match(/\?([^#]+)/)[1]:""}),this.location.__defineSetter__("search",function(e){u.location.href=u.location.href.indexOf("?")>0?u.location.href.replace(/\?([^#]+)/,e):u.location.href.match(/^([^#?]+)/)[0]+e+u.location.hash}),t&&t.document&&(t.document.location=this.location),this.addEventListener=function(){e.Node.prototype.addEventListener.apply(u,arguments)},this.removeEventListener=function(){e.Node.prototype.removeEventListener.apply(u,arguments)},this.dispatchEvent=function(){e.Node.prototype.dispatchEvent.apply(u,arguments)},this.raise=function(){e.Node.prototype.raise.apply(u.document,arguments)},this.setTimeout=function(e,t){return r(setTimeout,clearTimeout,e,t)},this.setInterval=function(e,t){return r(setInterval,clearInterval,e,t)},this.clearInterval=s,this.clearTimeout=s,this.__stopAllTimers=o}var n=[];u.prototype={__proto__:e,_length:0,get length(){return this._length},close:function(){var e=this;(function t(n){var r;if(n.length>0)for(r=0;r<n.length;r++)t(n[r]);n!==e&&n.close()})(this),this.document&&(this.document.body&&(this.document.body.innerHTML=""),this.document.close&&(this.document._listeners=[],this.document.close()),delete this.document),o(),this.dispose()},getComputedStyle:function(e){var t=e.style,n={};for(var r in t)n[r]=t[r];return n.__proto__={getPropertyValue:function(t){return e.style[t]}},n},console:{log:function(e){this._window.raise("log",e)},info:function(e){this._window.raise("info",e)},warn:function(e){this._window.raise("warn",e)},error:function(e){this._window.raise("error",e)}},navigator:{userAgent:"Node.js ("+process.platform+"; U; rv:"+process.version+")",appName:"Node.js jsDom",platform:process.platform,appVersion:process.version},XMLHttpRequest:function(){},name:"nodejs",innerWidth:1024,innerHeight:768,outerWidth:1024,outerHeight:768,pageXOffset:0,pageYOffset:0,screenX:0,screenY:0,screenLeft:0,screenTop:0,scrollX:0,scrollY:0,scrollTop:0,scrollLeft:0,alert:p(),blur:p(),confirm:p(),createPopup:p(),focus:p(),moveBy:p(),moveTo:p(),open:p(),print:p(),prompt:p(),resizeBy:p(),resizeTo:p(),scroll:p(),scrollBy:p(),scrollTo:p(),screen:{width:0,height:0},Image:p()};var a=new u(t);c(a);var f=a.getGlobal();return a.window=a.frames=a.self=a.parent=a.top=f,a};var d=null,m=t.browserAugmentation=function(e,n){function l(t,n){var r="",s="",o="",l="HTML",c=!0,h=n.match(i);t._doctype=null;if(h&&h[0])o=h[0];else{var p=n.indexOf(a),d=n.indexOf(f),v;if(p<0||d<0)return;v=n.substr(p,d-p+f.length),h=v.replace(/[\n\r]/g,"").match(u);if(!h)return;o=h[0],h=h[1].split(' "');var m=h.length?h.pop().replace(/"/g,""):"",g=h.length?h.pop().replace(/"/g,""):"";m.indexOf("-//")!==-1&&(r=m),g.indexOf("-//")!==-1&&(r=g),m.indexOf("://")!==-1&&(s=m),g.indexOf("://")!==-1&&(s=g),h.length&&(h=h[0].split(" "),l=h[0].toUpperCase())}t._doctype=(new e.DOMImplementation).createDocumentType(l,r,s),t._doctype._ownerDocument=t,t._doctype._fullDT=o,t._doctype.toString=function(){return this._fullDT}}if(e._augmented)return e;n||(n={});var r=new s(n.parser||v());e.HTMLDocument||(e.HTMLDocument=e.Document),e.HTMLDocument.prototype.write||(e.HTMLDocument.prototype.write=function(e){this.innerHTML=e}),e.Element.prototype.getElementsByClassName=function(t){function n(n){if(!n)return!1;n.nodeType&&n.nodeType===e.Node.ENTITY_REFERENCE_NODE&&(n=n._entity);var r=n.className;if(r){var i=r.split(" ");for(var s=0;s<i.length;s++)if(i[s]===t)return!0}return!1}return new e.NodeList(this.ownerDocument||this,e.mapper(this,n))},e.Element.prototype.__defineGetter__("sourceIndex",function(){var e=this.ownerDocument.getElementsByTagName("*"),t=e.length;for(var n=0;n<t;n++)if(e[n]===this)return n}),e.Document.prototype.__defineGetter__("outerHTML",function(){return o(this,!0)}),e.Element.prototype.__defineGetter__("outerHTML",function(){return o(this,!0)}),e.Element.prototype.__defineGetter__("innerHTML",function(){if(/^(?:script|style)$/.test(this._tagName)){var e=this.getAttribute("type");if(!e||/^text\//i.test(e)||/\/javascript$/i.test(e))return o(this._childNodes,!0,!0)}return o(this._childNodes,!0)}),e.Element.prototype.__defineSetter__("doctype",function(){throw new core.DOMException(NO_MODIFICATION_ALLOWED_ERR)}),e.Element.prototype.__defineGetter__("doctype",function(){var e=null;return this.nodeName=="#document"&&this._doctype&&(e=this._doctype),e}),e.Element.prototype.__defineSetter__("innerHTML",function(e){var t;while(t=this._childNodes[0])this.removeChild(t);return this.nodeName==="#document"&&l(this,e),e!==""&&e!=null&&r.appendHtmlToElement(e,this),e}),e.Document.prototype.__defineGetter__("innerHTML",function(){return o(this._childNodes,!0)}),e.Document.prototype.__defineSetter__("innerHTML",function(e){var t;while(t=this._childNodes[0])this.removeChild(t);return this.nodeName==="#document"&&l(this,e),e!==""&&e!=null&&r.appendHtmlToElement(e,this),e});var i=/<!doctype html>/i,u=/<!DOCTYPE (\w(.|\n)*)">/i,a="<!DOCTYPE ",f='">';return e.Document.prototype.getElementsByClassName=function(t){function n(n){if(!n)return!1;n.nodeType&&n.nodeType===e.Node.ENTITY_REFERENCE_NODE&&(n=n._entity);var r=n.className;if(r){var i=r.split(" ");for(var s=0;s<i.length;s++)if(i[s]===t)return!0}return!1}return new e.NodeList(this.ownerDocument||this,e.mapper(this,n))},e.Element.prototype.__defineGetter__("nodeName",function(e){return this._nodeName.toUpperCase()}),e.Element.prototype.__defineGetter__("tagName",function(e){var t=this._tagName.toUpperCase();return this.nodeName==="#document"&&(t=null),t}),e.Element.prototype.scrollTop=0,e.Element.prototype.scrollLeft=0,e.Document.prototype.__defineGetter__("parentWindow",function(){if(!this._parentWindow){var n=t.windowAugmentation(e,{document:this,url:this.URL});this._parentWindow=n.getGlobal()}return this._parentWindow}),e.Document.prototype.__defineSetter__("parentWindow",function(e){this._parentWindow=e.getGlobal()}),e.Document.prototype.__defineGetter__("defaultView",function(){return this.parentWindow}),e._augmented=!0,e}}})