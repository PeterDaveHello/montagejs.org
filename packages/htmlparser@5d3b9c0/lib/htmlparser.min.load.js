montageDefine("5d3b9c0","lib/htmlparser.min",{dependencies:[],factory:function(e,t,n){(function(){function r(e,t){this._options=t?t:{},void 0==this._options.includeLocation&&(this._options.includeLocation=!1),this.validateHandler(e),this._handler=e,this.reset()}function i(e){i.super_.call(this,e,{ignoreWhitespace:!0,verbose:!1,enforceEmptyTags:!1})}function s(e,t){this.reset(),this._options=t?t:{},void 0==this._options.ignoreWhitespace&&(this._options.ignoreWhitespace=!1),void 0==this._options.verbose&&(this._options.verbose=!0),void 0==this._options.enforceEmptyTags&&(this._options.enforceEmptyTags=!0),"function"==typeof e&&(this._callback=e)}if("function"!=typeof e||"object"!=typeof t||"object"!=typeof n||"string"!=typeof __filename||"string"!=typeof __dirname){if(this.Tautologistics){if(this.Tautologistics.NodeHtmlParser)return}else this.Tautologistics={};this.Tautologistics.NodeHtmlParser={},t=this.Tautologistics.NodeHtmlParser}var o={Text:"text",Directive:"directive",Comment:"comment",Script:"script",Style:"style",Tag:"tag"};r._reTrim=/(^\s+|\s+$)/g,r._reTrimComment=/(^\!--|--$)/g,r._reWhitespace=/\s/g,r._reTagName=/^\s*(\/?)\s*([^\s\/]+)/,r._reAttrib=/([^=<>\"\'\s]+)\s*=\s*"([^"]*)"|([^=<>\"\'\s]+)\s*=\s*'([^']*)'|([^=<>\"\'\s]+)\s*=\s*([^'"\s]+)|([^=<>\"\'\s\/]+)/g,r._reTags=/[\<\>]/g,r.prototype.parseComplete=function(e){this.reset(),this.parseChunk(e),this.done()},r.prototype.parseChunk=function(e){this._done&&this.handleError(Error("Attempted to parse chunk after parsing already done")),this._buffer+=e,this.parseTags()},r.prototype.done=function(){if(!this._done){this._done=!0;if(this._buffer.length){var e=this._buffer;this._buffer="",e={raw:e,data:this._parseState==o.Text?e:e.replace(r._reTrim,""),type:this._parseState};if(this._parseState==o.Tag||this._parseState==o.Script||this._parseState==o.Style)e.name=this.parseTagName(e.data);this.parseAttribs(e),this._elements.push(e)}this.writeHandler(),this._handler.done()}},r.prototype.reset=function(){this._buffer="",this._done=!1,this._elements=[],this._next=this._current=this._elementsCurrent=0,this._location={row:0,col:0,charOffset:0,inBuffer:0},this._parseState=o.Text,this._prevTagSep="",this._tagStack=[],this._handler.reset()},r.prototype._options=null,r.prototype._handler=null,r.prototype._buffer=null,r.prototype._done=!1,r.prototype._elements=null,r.prototype._elementsCurrent=0,r.prototype._current=0,r.prototype._next=0,r.prototype._location=null,r.prototype._parseState=o.Text,r.prototype._prevTagSep="",r.prototype._tagStack=null,r.prototype.parseTagAttribs=function(e){for(var t=e.length,n=0;n<t;){var r=e[n++];(r.type==o.Tag||r.type==o.Script||r.type==o.style)&&this.parseAttribs(r)}return e},r.prototype.parseAttribs=function(e){if(e.type==o.Script||e.type==o.Style||e.type==o.Tag){var t=e.data.split(r._reWhitespace,1)[0],t=e.data.substring(t.length);if(!(1>t.length)){var n;for(r._reAttrib.lastIndex=0;n=r._reAttrib.exec(t);)void 0==e.attribs&&(e.attribs={}),"string"==typeof n[1]&&n[1].length?e.attribs[n[1]]=n[2]:"string"==typeof n[3]&&n[3].length?e.attribs[n[3].toString()]=n[4].toString():"string"==typeof n[5]&&n[5].length?e.attribs[n[5]]=n[6]:"string"==typeof n[7]&&n[7].length&&(e.attribs[n[7]]=n[7])}}},r.prototype.parseTagName=function(e){return null==e||""==e?"":(e=r._reTagName.exec(e),e?(e[1]?"/":"")+e[2]:"")},r.prototype.parseTags=function(){for(var e=this._buffer.length-1;r._reTags.test(this._buffer);){this._next=r._reTags.lastIndex-1;var t=this._buffer.charAt(this._next),n=this._buffer.substring(this._current,this._next),n={raw:n,data:this._parseState==o.Text?n:n.replace(r._reTrim,""),type:this._parseState},i=this.parseTagName(n.data);if(this._tagStack.length)if(this._tagStack[this._tagStack.length-1]==o.Script){if("/script"==i.toLowerCase())this._tagStack.pop();else if(0!=n.raw.indexOf("!--")&&(n.type=o.Text,this._elements.length&&this._elements[this._elements.length-1].type==o.Text)){var s=this._elements[this._elements.length-1];s.raw=s.data=s.raw+this._prevTagSep+n.raw,n.raw=n.data=""}}else this._tagStack[this._tagStack.length-1]==o.Style?"/style"==i.toLowerCase()?this._tagStack.pop():0!=n.raw.indexOf("!--")&&(n.type=o.Text,this._elements.length&&this._elements[this._elements.length-1].type==o.Text?(s=this._elements[this._elements.length-1],""!=n.raw?(s.raw=s.data=s.raw+this._prevTagSep+n.raw,n.raw=n.data=""):s.raw=s.data=s.raw+this._prevTagSep):""!=n.raw&&(n.raw=n.data=n.raw)):this._tagStack[this._tagStack.length-1]==o.Comment&&(s=n.raw.length,"-"==n.raw.charAt(s-2)&&"-"==n.raw.charAt(s-1)&&">"==t?(this._tagStack.pop(),this._elements.length&&this._elements[this._elements.length-1].type==o.Comment?(s=this._elements[this._elements.length-1],s.raw=s.data=(s.raw+n.raw).replace(r._reTrimComment,""),n.raw=n.data="",n.type=o.Text):n.type=o.Comment):(n.type=o.Comment,this._elements.length&&this._elements[this._elements.length-1].type==o.Comment?(s=this._elements[this._elements.length-1],s.raw=s.data=s.raw+n.raw+t,n.raw=n.data="",n.type=o.Text):n.raw=n.data=n.raw+t));n.type==o.Tag&&(n.name=i,i=i.toLowerCase(),0==n.raw.indexOf("!--")?(n.type=o.Comment,delete n.name,s=n.raw.length,"-"==n.raw.charAt(s-1)&&"-"==n.raw.charAt(s-2)&&">"==t?n.raw=n.data=n.raw.replace(r._reTrimComment,""):(n.raw+=t,this._tagStack.push(o.Comment))):0==n.raw.indexOf("!")||0==n.raw.indexOf("?")?n.type=o.Directive:"script"==i?(n.type=o.Script,"/"!=n.data.charAt(n.data.length-1)&&this._tagStack.push(o.Script)):"/script"==i?n.type=o.Script:"style"==i?(n.type=o.Style,"/"!=n.data.charAt(n.data.length-1)&&this._tagStack.push(o.Style)):"/style"==i&&(n.type=o.Style),n.name&&"/"==n.name.charAt(0))&&(n.data=n.name);if(""!=n.raw||n.type!=o.Text)this._options.includeLocation&&!n.location&&(n.location=this.getLocation(n.type==o.Tag)),this.parseAttribs(n),this._elements.push(n),n.type!=o.Text&&n.type!=o.Comment&&n.type!=o.Directive&&"/"==n.data.charAt(n.data.length-1)&&this._elements.push({raw:"/"+n.name,data:"/"+n.name,name:"/"+n.name,type:n.type});this._parseState="<"==t?o.Tag:o.Text,this._current=this._next+1,this._prevTagSep=t}this._options.includeLocation&&(this.getLocation(),this._location.row+=this._location.inBuffer,this._location.inBuffer=0,this._location.charOffset=0),this._buffer=this._current<=e?this._buffer.substring(this._current):"",this._current=0,this.writeHandler()},r.prototype.getLocation=function(e){for(var t=this._location,n=this._current-(e?1:0),r=e&&0==t.charOffset&&0==this._current;t.charOffset<n;t.charOffset++)e=this._buffer.charAt(t.charOffset),"\n"==e?(t.inBuffer++,t.col=0):"\r"!=e&&t.col++;return{line:t.row+t.inBuffer+1,col:t.col+(r?0:1)}},r.prototype.validateHandler=function(e){if("object"!=typeof e)throw Error("Handler is not an object");if("function"!=typeof e.reset)throw Error("Handler method 'reset' is invalid");if("function"!=typeof e.done)throw Error("Handler method 'done' is invalid");if("function"!=typeof e.writeTag)throw Error("Handler method 'writeTag' is invalid");if("function"!=typeof e.writeText)throw Error("Handler method 'writeText' is invalid");if("function"!=typeof e.writeComment)throw Error("Handler method 'writeComment' is invalid");if("function"!=typeof e.writeDirective)throw Error("Handler method 'writeDirective' is invalid")},r.prototype.writeHandler=function(e){if(!this._tagStack.length||e)for(;this._elements.length;)switch(e=this._elements.shift(),e.type){case o.Comment:this._handler.writeComment(e);break;case o.Directive:this._handler.writeDirective(e);break;case o.Text:this._handler.writeText(e);break;default:this._handler.writeTag(e)}},r.prototype.handleError=function(e){if("function"!=typeof this._handler.error)throw e;this._handler.error(e)},function(e,t){var n=function(){};n.prototype=t.prototype,e.super_=t,e.prototype=new n,e.prototype.constructor=e}(i,s),i.prototype.done=function(){var e={},t,n=u.getElementsByTagName(function(e){return"rss"==e||"feed"==e},this.dom,!1);n.length&&(t=n[0]);if(t){if("rss"==t.name){e.type="rss",t=t.children[0],e.id="";try{e.title=u.getElementsByTagName("title",t.children,!1)[0].children[0].data}catch(r){}try{e.link=u.getElementsByTagName("link",t.children,!1)[0].children[0].data}catch(s){}try{e.description=u.getElementsByTagName("description",t.children,!1)[0].children[0].data}catch(o){}try{e.updated=new Date(u.getElementsByTagName("lastBuildDate",t.children,!1)[0].children[0].data)}catch(a){}try{e.author=u.getElementsByTagName("managingEditor",t.children,!1)[0].children[0].data}catch(l){}e.items=[],u.getElementsByTagName("item",t.children).forEach(function(t){var n={};try{n.id=u.getElementsByTagName("guid",t.children,!1)[0].children[0].data}catch(r){}try{n.title=u.getElementsByTagName("title",t.children,!1)[0].children[0].data}catch(i){}try{n.link=u.getElementsByTagName("link",t.children,!1)[0].children[0].data}catch(s){}try{n.description=u.getElementsByTagName("description",t.children,!1)[0].children[0].data}catch(o){}try{n.pubDate=new Date(u.getElementsByTagName("pubDate",t.children,!1)[0].children[0].data)}catch(a){}e.items.push(n)})}else{e.type="atom";try{e.id=u.getElementsByTagName("id",t.children,!1)[0].children[0].data}catch(c){}try{e.title=u.getElementsByTagName("title",t.children,!1)[0].children[0].data}catch(h){}try{e.link=u.getElementsByTagName("link",t.children,!1)[0].attribs.href}catch(p){}try{e.description=u.getElementsByTagName("subtitle",t.children,!1)[0].children[0].data}catch(d){}try{e.updated=new Date(u.getElementsByTagName("updated",t.children,!1)[0].children[0].data)}catch(v){}try{e.author=u.getElementsByTagName("email",t.children,!0)[0].children[0].data}catch(m){}e.items=[],u.getElementsByTagName("entry",t.children).forEach(function(t){var n={};try{n.id=u.getElementsByTagName("id",t.children,!1)[0].children[0].data}catch(r){}try{n.title=u.getElementsByTagName("title",t.children,!1)[0].children[0].data}catch(i){}try{n.link=u.getElementsByTagName("link",t.children,!1)[0].attribs.href}catch(s){}try{n.description=u.getElementsByTagName("summary",t.children,!1)[0].children[0].data}catch(o){}try{n.pubDate=new Date(u.getElementsByTagName("updated",t.children,!1)[0].children[0].data)}catch(a){}e.items.push(n)})}this.dom=e}i.super_.prototype.done.call(this)},s._emptyTags={area:1,base:1,basefont:1,br:1,col:1,frame:1,hr:1,img:1,input:1,isindex:1,link:1,meta:1,param:1,embed:1},s.reWhitespace=/^\s*$/,s.prototype.dom=null,s.prototype.reset=function(){this.dom=[],this._done=!1,this._tagStack=[],this._tagStack.last=function(){return this.length?this[this.length-1]:null}},s.prototype.done=function(){this._done=!0,this.handleCallback(null)},s.prototype.writeTag=function(e){this.handleElement(e)},s.prototype.writeText=function(e){(!this._options.ignoreWhitespace||!s.reWhitespace.test(e.data))&&this.handleElement(e)},s.prototype.writeComment=function(e){this.handleElement(e)},s.prototype.writeDirective=function(e){this.handleElement(e)},s.prototype.error=function(e){this.handleCallback(e)},s.prototype._options=null,s.prototype._callback=null,s.prototype._done=!1,s.prototype._tagStack=null,s.prototype.handleCallback=function(e){if("function"!=typeof this._callback){if(e)throw e}else this._callback(e,this.dom)},s.prototype.isEmptyTag=function(e){return e=e.name.toLowerCase(),"/"==e.charAt(0)&&(e=e.substring(1)),this._options.enforceEmptyTags&&!!s._emptyTags[e]},s.prototype.handleElement=function(e){this._done&&this.handleCallback(Error("Writing to the handler after done() called is not allowed without a reset()")),this._options.verbose||(delete e.raw,("tag"==e.type||"script"==e.type||"style"==e.type)&&delete e.data);if(this._tagStack.last())if(e.type!=o.Text&&e.type!=o.Comment&&e.type!=o.Directive)if("/"==e.name.charAt(0)){var t=e.name.substring(1);if(!this.isEmptyTag(e)){for(e=this._tagStack.length-1;-1<e&&this._tagStack[e--].name!=t;);if(-1<e||this._tagStack[0].name==t)for(;e<this._tagStack.length-1;)this._tagStack.pop()}}else this._tagStack.last().children||(this._tagStack.last().children=[]),this._tagStack.last().children.push(e),this.isEmptyTag(e)||this._tagStack.push(e);else this._tagStack.last().children||(this._tagStack.last().children=[]),this._tagStack.last().children.push(e);else e.type!=o.Text&&e.type!=o.Comment&&e.type!=o.Directive?"/"!=e.name.charAt(0)&&(this.dom.push(e),this.isEmptyTag(e)||this._tagStack.push(e)):this.dom.push(e)};var u={testElement:function(e,t){if(!t)return!1;for(var n in e)if("tag_name"==n){if("tag"!=t.type&&"script"!=t.type&&"style"!=t.type||!e.tag_name(t.name))return!1}else if("tag_type"==n){if(!e.tag_type(t.type))return!1}else if("tag_contains"==n){if("text"!=t.type&&"comment"!=t.type&&"directive"!=t.type||!e.tag_contains(t.data))return!1}else if(!t.attribs||!e[n](t.attribs[n]))return!1;return!0},getElements:function(e,t,n,r){function i(e){return function(t){return t==e}}n=void 0===n||null===n||!!n,r=isNaN(parseInt(r))?-1:parseInt(r);if(!t)return[];var s=[],o;for(o in e)"function"!=typeof e[o]&&(e[o]=i(e[o]));u.testElement(e,t)&&s.push(t);if(0<=r&&s.length>=r)return s;if(n&&t.children)t=t.children;else if(!(t instanceof Array))return s;for(o=0;o<t.length&&!(s=s.concat(u.getElements(e,t[o],n,r)),0<=r&&s.length>=r);o++);return s},getElementById:function(e,t,n){return e=u.getElements({id:e},t,n,1),e.length?e[0]:null},getElementsByTagName:function(e,t,n,r){return u.getElements({tag_name:e},t,n,r)},getElementsByTagType:function(e,t,n,r){return u.getElements({tag_type:e},t,n,r)}};t.Parser=r,t.DefaultHandler=s,t.RssHandler=i,t.ElementType=o,t.DomUtils=u})()}})