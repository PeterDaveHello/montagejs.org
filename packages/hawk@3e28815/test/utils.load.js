montageDefine("3e28815","test/utils",{dependencies:["lab","../lib","../package.json"],factory:function(e,t,n){var r=e("lab"),i=e("../lib"),s=e("../package.json"),o={},u=r.expect,a=r.before,f=r.after,l=r.experiment,c=r.test;l("Hawk",function(){l("Utils",function(){l("#parseHost",function(){c("returns port 80 for non tls node request",function(e){var t={method:"POST",url:"/resource/4?filter=a",headers:{host:"example.com","content-type":"text/plain;x=y"}};u(i.utils.parseHost(t,"Host").port).to.equal(80),e()}),c("returns port 443 for non tls node request",function(e){var t={method:"POST",url:"/resource/4?filter=a",headers:{host:"example.com","content-type":"text/plain;x=y"},connection:{encrypted:!0}};u(i.utils.parseHost(t,"Host").port).to.equal(443),e()})}),l("#version",function(){c("returns the correct package version number",function(e){u(i.utils.version()).to.equal(s.version),e()})}),l("#unauthorized",function(){c("returns a hawk 401",function(e){u(i.utils.unauthorized("kaboom").response.headers["WWW-Authenticate"]).to.equal('Hawk error="kaboom"'),e()})})})})}})