montageDefine("3e28815","test/readme",{dependencies:["lab","hoek","../lib"],factory:function(e,t,n){var r=e("lab"),i=e("hoek"),s=e("../lib"),o={},u=r.expect,a=r.before,f=r.after,l=r.experiment,c=r.test;l("Hawk",function(){l("README",function(){l("core",function(){var e={id:"dh37fgj492je",key:"werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn",algorithm:"sha256"},t={credentials:e,timestamp:1353832234,nonce:"j4h3g2",ext:"some-app-ext-data"};c("should generate a header protocol example",function(e){var n=s.client.header("http://example.com:8000/resource/1?b=1&a=2","GET",t).field;u(n).to.equal('Hawk id="dh37fgj492je", ts="1353832234", nonce="j4h3g2", ext="some-app-ext-data", mac="6R4rV5iE+NPoym+WwjeHzjAGXUtLNIxmo1vpMofpLAE="'),e()}),c("should generate a normalized string protocol example",function(n){var r=s.crypto.generateNormalizedString("header",{credentials:e,ts:t.timestamp,nonce:t.nonce,method:"GET",resource:"/resource?a=1&b=2",host:"example.com",port:8e3,ext:t.ext});u(r).to.equal("hawk.1.header\n1353832234\nj4h3g2\nGET\n/resource?a=1&b=2\nexample.com\n8000\n\nsome-app-ext-data\n"),n()});var n=i.clone(t);n.payload="Thank you for flying Hawk",n.contentType="text/plain",c("should generate a header protocol example (with payload)",function(e){var t=s.client.header("http://example.com:8000/resource/1?b=1&a=2","POST",n).field;u(t).to.equal('Hawk id="dh37fgj492je", ts="1353832234", nonce="j4h3g2", hash="Yi9LfIIFRtBEPt74PVmbTF/xVAwPn7ub15ePICfgnuY=", ext="some-app-ext-data", mac="aSe1DERmZuRl3pI36/9BdZmnErTw3sNzOOAUlfeKjVw="'),e()}),c("should generate a normalized string protocol example (with payload)",function(r){var i=s.crypto.generateNormalizedString("header",{credentials:e,ts:t.timestamp,nonce:t.nonce,method:"POST",resource:"/resource?a=1&b=2",host:"example.com",port:8e3,hash:s.crypto.calculatePayloadHash(n.payload,e.algorithm,n.contentType),ext:t.ext});u(i).to.equal("hawk.1.header\n1353832234\nj4h3g2\nPOST\n/resource?a=1&b=2\nexample.com\n8000\nYi9LfIIFRtBEPt74PVmbTF/xVAwPn7ub15ePICfgnuY=\nsome-app-ext-data\n"),r()})})})})}})