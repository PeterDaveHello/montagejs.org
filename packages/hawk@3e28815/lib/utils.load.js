montageDefine("3e28815","lib/utils",{dependencies:["hoek","sntp","boom"],factory:function(e,t,n){var r=e("hoek"),i=e("sntp"),s=e("boom"),o={};o.import=function(){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])},o.import(),t.version=function(){return t.loadPackage(__dirname+"/..").version},t.parseHost=function(e,t){t=t?t.toLowerCase():"host";var n=e.headers[t];if(!n)return null;var r=/^(?:(?:\r\n)?[\t ])*([^:]+)(?::(\d+))?(?:(?:\r\n)?[\t ])*$/,i=n.match(r);return!i||i.length!==3||!i[1]?null:{name:i[1],port:i[2]?i[2]:e.connection&&e.connection.encrypted?443:80}},t.parseContentType=function(e){return e?e.split(";")[0].trim().toLowerCase():""},t.parseRequest=function(e,n){if(!e.headers)return e;var r=t.parseHost(e,n.hostHeaderName);if(!r)return new Error("Invalid Host header");var i={method:e.method,url:e.url,host:r.name,port:r.port,authorization:e.headers.authorization,contentType:e.headers["content-type"]||""};return i},t.now=function(){return i.now()},t.parseAuthorizationHeader=function(e,t){t=t||["id","ts","nonce","hash","ext","mac","app","dlg"];if(!e)return s.unauthorized(null,"Hawk");var n=e.match(/^(\w+)(?:\s+(.*))?$/);if(!n)return s.badRequest("Invalid header syntax");var r=n[1];if(r.toLowerCase()!=="hawk")return s.unauthorized(null,"Hawk");var i=n[2];if(!i)return s.badRequest("Invalid header syntax");var o={},u="",a=i.replace(/(\w+)="([^"\\]*)"\s*(?:,\s*|$)/g,function(e,n,r){if(t.indexOf(n)===-1){u="Unknown attribute: "+n;return}if(r.match(/^[ \w\!#\$%&'\(\)\*\+,\-\.\/\:;<\=>\?@\[\]\^`\{\|\}~]+$/)===null){u="Bad attribute value: "+n;return}if(o.hasOwnProperty(n)){u="Duplicate attribute: "+n;return}return o[n]=r,""});return a!==""?s.badRequest(u||"Bad header format"):o},t.unauthorized=function(e){return s.unauthorized(e,"Hawk")}}})