montageDefine("3e28815","lib/crypto",{dependencies:["crypto","url","./utils"],factory:function(e,t,n){var r=e("crypto"),i=e("url"),s=e("./utils"),o={};t.headerVersion="1",t.algorithms=["sha1","sha256"],t.calculateMac=function(e,n,i){var s=t.generateNormalizedString(e,i),o=r.createHmac(n.algorithm,n.key).update(s),u=o.digest("base64");return u},t.generateNormalizedString=function(e,n){var r="hawk."+t.headerVersion+"."+e+"\n"+n.ts+"\n"+n.nonce+"\n"+n.method.toUpperCase()+"\n"+n.resource+"\n"+n.host.toLowerCase()+"\n"+n.port+"\n"+(n.hash||"")+"\n";return n.ext&&(r+=n.ext.replace("\\","\\\\").replace("\n","\\n")),r+="\n",n.app&&(r+=n.app+"\n"+(n.dlg||"")+"\n"),r},t.calculatePayloadHash=function(e,n,r){var i=t.initializePayloadHash(n,r);return i.update(e||""),t.finalizePayloadHash(i)},t.initializePayloadHash=function(e,n){var i=r.createHash(e);return i.update("hawk."+t.headerVersion+".payload\n"),i.update(s.parseContentType(n)+"\n"),i},t.finalizePayloadHash=function(e){return e.update("\n"),e.digest("base64")},t.calculateTsMac=function(e,n){var i=r.createHmac(n.algorithm,n.key);return i.update("hawk."+t.headerVersion+".ts\n"+e+"\n"),i.digest("base64")}}})