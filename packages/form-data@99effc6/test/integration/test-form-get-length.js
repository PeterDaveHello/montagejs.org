var common=require("../common"),assert=common.assert,FormData=require(common.dir.lib+"/form_data"),fake=require("fake").create(),fs=require("fs");(function(){var t=new FormData,n=fake.callback(arguments.callee.name+"-getLength"),r=fake.expectAnytime(n,[null,0]).calls;t.getLength(n),assert.strictEqual(r.length,0)})(),function(){var t="my_field",n="May the â‚¬ be with you",r=new FormData;r.append(t,n);var i=fake.callback(arguments.callee.name+"-getLength"),s=r._overheadLength+Buffer.byteLength(n)+r._lastBoundary().length;fake.expectAnytime(i,[null,s]),r.getLength(i)}(),function(){var t="my_field",n=new Buffer(23),r=new FormData;r.append(t,n);var i=fake.callback(arguments.callee.name+"-getLength"),s=r._overheadLength+n.length+r._lastBoundary().length;fake.expectAnytime(i,[null,s]),r.getLength(i)}(),function(){var t=[{name:"my_field",value:"Test 123"},{name:"my_image",value:fs.createReadStream(common.dir.fixture+"/unicycle.jpg")},{name:"my_buffer",value:new Buffer("123")},{name:"my_txt",value:fs.createReadStream(common.dir.fixture+"/bacon.txt")}],n=new FormData,r=0;t.forEach(function(e){n.append(e.name,e.value);if(e.value.path){var t=fs.statSync(e.value.path);r+=t.size}else r+=e.value.length}),r+=n._overheadLength+n._lastBoundary().length;var i=fake.callback(arguments.callee.name+"-getLength");fake.expectAnytime(i,[null,r]),n.getLength(i)}()