montageDefine("99effc6","test/integration/test-custom-filename",{dependencies:["../common","http","fs","formidable"],factory:function(e,t,n){var r=e("../common"),i=r.assert,s=e("http"),o=e("fs"),u=e(r.dir.lib+"/form_data"),a=e("formidable").IncomingForm,f={filename:"test.png",contentType:"image/gif"},l=s.createServer(function(e,t){var n=new a({uploadDir:r.dir.tmp});n.parse(e),n.on("file",function(e,t){i.strictEqual(e,"my_file"),i.strictEqual(t.name,f.filename),i.strictEqual(t.type,f.contentType)}).on("end",function(){t.writeHead(200),t.end("done")})});l.listen(r.port,function(){var e=new u;e.append("my_file",o.createReadStream(r.dir.fixture+"/unicycle.jpg"),f),e.submit("http://localhost:"+r.port+"/",function(e,t){if(e)throw e;i.strictEqual(t.statusCode,200),l.close()})})}})