montageDefine("776c0cc","test/index",{dependencies:["lab","../lib"],factory:function(e,t,n){var r=e("lab"),i=e("../lib"),s={},o=r.expect,u=r.before,a=r.after,f=r.experiment,l=r.test;f("Cryptiles",function(){f("#randomString",function(){l("should generate the right length string",function(e){for(var t=1;t<=1e3;++t)o(i.randomString(t).length).to.equal(t);e()}),l("returns an error on invalid bits size",function(e){o(i.randomString(1e20).message).to.equal("Failed generating random bits: Argument #1 must be number > 0"),e()})}),f("#randomBits",function(){l("returns an error on invalid input",function(e){o(i.randomBits(0).message).to.equal("Invalid random bits count"),e()})}),f("#fixedTimeComparison",function(){var e=i.randomString(5e4),t=i.randomString(15e4);l("should take the same amount of time comparing different string sizes",function(n){var r=Date.now();i.fixedTimeComparison(t,e);var s=Date.now()-r;r=Date.now(),i.fixedTimeComparison(t,t);var u=Date.now()-r;o(u-s).to.be.within(-20,20),n()}),l("should return true for equal strings",function(t){o(i.fixedTimeComparison(e,e)).to.equal(!0),t()}),l("should return false for different strings (size, a < b)",function(t){o(i.fixedTimeComparison(e,e+"x")).to.equal(!1),t()}),l("should return false for different strings (size, a > b)",function(t){o(i.fixedTimeComparison(e+"x",e)).to.equal(!1),t()}),l("should return false for different strings (size, a = b)",function(t){o(i.fixedTimeComparison(e+"x",e+"y")).to.equal(!1),t()})})})}})