"use strict";function graphOt(e,t){for(var n,a=(t.length+1)*(e.length+1),s=Array(a),i=Array(t.length+1),r=Array(t.length+1),o=0;e.length+1>o;o++){for(var l=0;t.length+1>l;l++){var c,p;if(0===o&&0===l)c=" ",p=0;else if(0===o)c="insert",p=l;else if(0===l)c="delete",p=o;else if(e[o-1]===t[l-1])c="retain",p=r[l-1];else{var h=i[l-1],u=r[l];h>u?(c="delete",p=u+1):(c="insert",p=h+1)}s[o+l*(e.length+1)]=c,i[l]=p}n=i,i=r,r=n}return{edges:s,cost:r[t.length],source:t,target:e}}function traceOt(e){for(var t,n,a=[],s=e.edges,i=t=e.target.length,r=e.source.length;t||r;){var o=s[t+r*(i+1)];if("delete"===o){if(n&&"delete"===n[0])n[1]++;else{var l=["delete",1];n=l,a.push(l)}t--}else if("insert"===o){if(n&&"insert"===n[0])n[1]++;else{var l=["insert",1];n=l,a.push(l)}r--}else if("retain"===o){var l=["retain",1];n&&"retain"===n[0]?n[1]++:(n=l,a.push(l)),t--,r--}}return a.reverse(),a}function ot(e,t){return traceOt(graphOt(e,t))}function diff(e,t){for(var n=ot(e,t),a=[],s=0,i=0,r=0;n.length>r;){var o=n[r++];if("insert"===o[0])a.push([i,0,t.slice(i,i+o[1])]),i+=o[1];else if("delete"===o[0])if(n.length>r&&"insert"===n[r][0]){var l=n[r++];a.push([i,o[1],t.slice(i,i+l[1])]),s+=o[1],i+=l[1]}else a.push([i,o[1]]),s+=o[1];else"retain"==o[0]&&(s+=o[1],i+=o[1])}return a}function apply(e,t){for(var n=0;t.length>n;n++)e.swap.apply(e,t[n])}function merge(e,t){apply(e,diff(e,t))}require("collections/shim"),exports.graphOt=graphOt,exports.traceOt=traceOt,exports.ot=ot,exports.diff=diff,exports.apply=apply,exports.merge=merge;