montageDefine("a8ce47e","lib/ber/reader",{dependencies:["assert","./types","./errors"],factory:function(e,t,n){function u(e){if(!e||!Buffer.isBuffer(e))throw new TypeError("data must be a node Buffer");this._buf=e,this._size=e.length,this._len=0,this._offset=0;var t=this;this.__defineGetter__("length",function(){return t._len}),this.__defineGetter__("offset",function(){return t._offset}),this.__defineGetter__("remain",function(){return t._size-t._offset}),this.__defineGetter__("buffer",function(){return t._buf.slice(t._offset)})}var r=e("assert"),i=e("./types"),s=e("./errors"),o=s.newInvalidAsn1Error;u.prototype.readByte=function(e){if(this._size-this._offset<1)return null;var t=this._buf[this._offset]&255;return e||(this._offset+=1),t},u.prototype.peek=function(){return this.readByte(!0)},u.prototype.readLength=function(e){e===undefined&&(e=this._offset);if(e>=this._size)return null;var t=this._buf[e++]&255;if(t===null)return null;if((t&128)==128){t&=127;if(t==0)throw o("Indefinite length not supported");if(t>4)throw o("encoding too long");if(this._size-e<t)return null;this._len=0;for(var n=0;n<t;n++)this._len=(this._len<<8)+(this._buf[e++]&255)}else this._len=t;return e},u.prototype.readSequence=function(e){var t=this.peek();if(t===null)return null;if(e!==undefined&&e!==t)throw o("Expected 0x"+e.toString(16)+": got 0x"+t.toString(16));var n=this.readLength(this._offset+1);return n===null?null:(this._offset=n,t)},u.prototype.readInt=function(){return this._readTag(i.Integer)},u.prototype.readBoolean=function(){return this._readTag(i.Boolean)===0?!1:!0},u.prototype.readEnumeration=function(){return this._readTag(i.Enumeration)},u.prototype.readString=function(e,t){e||(e=i.OctetString);var n=this.peek();if(n===null)return null;if(n!==e)throw o("Expected 0x"+e.toString(16)+": got 0x"+n.toString(16));var r=this.readLength(this._offset+1);if(r===null)return null;if(this.length>this._size-r)return null;this._offset=r;if(this.length===0)return"";var s=this._buf.slice(this._offset,this._offset+this.length);return this._offset+=this.length,t?s:s.toString("utf8")},u.prototype.readOID=function(e){e||(e=i.OID);var t=this.peek();if(t===null)return null;if(t!==e)throw o("Expected 0x"+e.toString(16)+": got 0x"+t.toString(16));var n=this.readLength(this._offset+1);if(n===null)return null;if(this.length>this._size-n)return null;this._offset=n;var r=[],s=0;for(var u=0;u<this.length;u++){var a=this._buf[this._offset++]&255;s<<=7,s+=a&127,(a&128)==0&&(r.push(s),s=0)}return s=r.shift(),r.unshift(s%40),r.unshift(s/40>>0),r.join(".")},u.prototype._readTag=function(e){r.ok(e!==undefined);var t=this.peek();if(t===null)return null;if(t!==e)throw o("Expected 0x"+e.toString(16)+": got 0x"+t.toString(16));var n=this.readLength(this._offset+1);if(n===null)return null;if(this.length>4)throw o("Integer too long: "+this.length);if(this.length>this._size-n)return null;this._offset=n;var i=this._buf[this._offset++],s=0;s=i&127;for(var u=1;u<this.length;u++)s<<=8,s|=this._buf[this._offset++]&255;return(i&128)==128&&(s=-s),s},n.exports=u}})