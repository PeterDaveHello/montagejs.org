"use strict";function RangeChanges(){throw Error("Can't construct. RangeChanges is a mixin.")}var WeakMap=require("../weak-map"),Dict=require("../dict"),rangeChangeDescriptors=new WeakMap;module.exports=RangeChanges,RangeChanges.prototype.getAllRangeChangeDescriptors=function(){return rangeChangeDescriptors.has(this)||rangeChangeDescriptors.set(this,Dict()),rangeChangeDescriptors.get(this)},RangeChanges.prototype.getRangeChangeDescriptor=function(e){var t=this.getAllRangeChangeDescriptors();return e=e||"",t.has(e)||t.set(e,{isActive:!1,changeListeners:[],willChangeListeners:[]}),t.get(e)},RangeChanges.prototype.addRangeChangeListener=function(e,t,n){!this.isObservable&&this.makeObservable&&this.makeObservable();var a,s=this.getRangeChangeDescriptor(t);a=n?s.willChangeListeners:s.changeListeners,a.push(e),this.dispatchesRangeChanges=!0;var i=this;return function(){i&&(i.removeRangeChangeListener(e,t,n),i=null)}},RangeChanges.prototype.removeRangeChangeListener=function(e,t,n){var a,s=this.getRangeChangeDescriptor(t);a=n?s.willChangeListeners:s.changeListeners;var i=a.lastIndexOf(e);if(-1===i)throw Error("Can't remove listener: does not exist.");a.splice(i,1)},RangeChanges.prototype.dispatchRangeChange=function(e,t,n,a){var s=this.getAllRangeChangeDescriptors(),i="Range"+(a?"WillChange":"Change");s.forEach(function(s,r){if(!s.isActive){s.isActive=!0;var o;o=a?s.willChangeListeners:s.changeListeners;var l="handle"+(r.slice(0,1).toUpperCase()+r.slice(1))+i;try{o.forEach(function(s){if(s[l])s[l](e,t,n,this,a);else{if(!s.call)throw Error("Handler "+s+" has no method "+l+" and is not callable");s.call(this,e,t,n,this,a)}},this)}finally{s.isActive=!1}}},this)},RangeChanges.prototype.addBeforeRangeChangeListener=function(e,t){return this.addRangeChangeListener(e,t,!0)},RangeChanges.prototype.removeBeforeRangeChangeListener=function(e,t){return this.removeRangeChangeListener(e,t,!0)},RangeChanges.prototype.dispatchBeforeRangeChange=function(e,t,n){return this.dispatchRangeChange(e,t,n,!0)};