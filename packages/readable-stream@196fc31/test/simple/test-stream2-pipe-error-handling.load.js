montageDefine("196fc31","test/simple/test-stream2-pipe-error-handling",{dependencies:["../common","assert","../../readable"],factory:function(e){e("../common");var t=e("assert"),n=e("../../readable");(function(){var e=1e3,a=new n.Readable;a._read=function(t){t=Math.min(e,t),e-=t,a.push(new Buffer(t))};var s;a.unpipe=function(e){s=e,n.Readable.prototype.unpipe.call(this,e)};var i=new n.Writable;i._write=function(e,t,n){n()},a.pipe(i);var r=null;i.on("error",function(e){r=e});var o;i.on("unpipe",function(e){o=e});var l=Error("This stream turned into bacon.");i.emit("error",l),t.strictEqual(r,l),t.strictEqual(o,a),t.strictEqual(s,i)})(),function(){var e=1e3,a=new n.Readable;a._read=function(t){t=Math.min(e,t),e-=t,a.push(new Buffer(t))};var s;a.unpipe=function(e){s=e,n.Readable.prototype.unpipe.call(this,e)};var i=new n.Writable;i._write=function(e,t,n){n()},a.pipe(i);var r;i.on("unpipe",function(e){r=e});var o=Error("This stream turned into bacon."),l=null;try{i.emit("error",o)}catch(c){l=c}t.strictEqual(l,o),t.strictEqual(r,a),t.strictEqual(s,i)}()}});