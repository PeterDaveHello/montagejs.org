montageDefine("196fc31","test/simple/test-stream2-push",{dependencies:["../common.js","../../readable","assert","util","events"],factory:function(e){function t(){console.error("readStart"),d=!0}function n(){console.error("readStop"),d=!1,process.nextTick(function(){var e=i.read();null!==e&&g.write(e)})}function a(){c(d),h.emit("data",v),c(d),h.emit("data",v),c(d),h.emit("data",v),c(d),h.emit("data",v),c(!d),5>y++?setTimeout(a,10):r()}function s(){console.error("finish"),c.deepEqual(m,f),console.log("ok")}function r(){h.emit("end"),c(!d),g.end(i.read()),setTimeout(function(){c(u)})}e("../common.js");var i=e("../../readable"),o=i.Readable,l=i.Writable,c=e("assert");e("util");var p=e("events").EventEmitter,i=new o({highWaterMark:16,encoding:"utf8"}),h=new p;i._read=function(){console.error("stream._read"),t()};var u=!1;i.on("end",function(){u=!0}),h.on("data",function(e){var t=i.push(e);console.error("data",i._readableState.length),t||n()}),h.on("end",function(){i.push(null)});var d=!1,g=new l({decodeStrings:!1}),m=[],f=["asdfgasdfgasdfgasdfg","asdfgasdfgasdfgasdfg","asdfgasdfgasdfgasdfg","asdfgasdfgasdfgasdfg","asdfgasdfgasdfgasdfg","asdfgasdfgasdfgasdfg"];g._write=function(e,t,n){console.error("WRITE %s",e),m.push(e),process.nextTick(n)},g.on("finish",s);var v="asdfg",y=0;t(),a()}});